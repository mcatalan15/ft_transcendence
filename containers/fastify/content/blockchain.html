<!DOCTYPE html>
<html>
<head>
  <title>Tournament Scores</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 500px; margin: 20px auto; padding: 20px; }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; font-weight: bold; }
    input { width: 100%; padding: 8px; box-sizing: border-box; }
    button { 
      background: #4CAF50; 
      color: white; 
      border: none; 
      padding: 10px 15px; 
      cursor: pointer; 
      font-size: 16px;
    }
    #result { 
      margin-top: 20px; 
      padding: 15px; 
      border-radius: 5px; 
      display: none;
    }
    .success { background: #dff0d8; color: #3c763d; border: 1px solid #3c763d; }
    .error { background: #f2dede; color: #a94442; border: 1px solid #a94442; }
    .tx-link { color: #31708f; text-decoration: underline; }
  </style>
</head>
<body>
  <h1>Tournament Contract Creator</h1>
  
  <div class="form-group">
    <label for="teamA">Team A Score:</label>
    <input type="number" id="teamA" min="0" required>
  </div>
  
  <div class="form-group">
    <label for="teamB">Team B Score:</label>
    <input type="number" id="teamB" min="0" required>
  </div>
  
  <button onclick="deployContract()">Generate Smart Contract</button>
  
  <div id="result"></div>

  <script>
    async function deployContract() {
      const teamA = document.getElementById('teamA').value;
      const teamB = document.getElementById('teamB').value;
      const resultDiv = document.getElementById('result');
      
      // Validate inputs
      if (!teamA || !teamB) {
        showError('Please enter both scores');
        return;
      }

      try {
        const response = await fetch('/blockchain/deploy-contract', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ 
            teamAScore: parseInt(teamA), 
            teamBScore: parseInt(teamB) 
          })
        });
        
        const data = await response.json();
        
        if (data.success) {
          showSuccess(`
            <p><strong>Contract deployed successfully!</strong></p>
            <p>Contract Address: ${data.contractAddress}</p>
            <p>Transaction: <a href="https://testnet.snowtrace.io/tx/${data.transactionHash}" 
               target="_blank" class="tx-link">View on Snowtrace</a></p>
          `);
        } else {
          showError(data.error || 'Deployment failed');
        }
      } catch (error) {
        showError('Network error: ' + error.message);
      }
    }

    function showSuccess(message) {
      const resultDiv = document.getElementById('result');
      resultDiv.className = 'success';
      resultDiv.innerHTML = message;
      resultDiv.style.display = 'block';
    }

    function showError(message) {
      const resultDiv = document.getElementById('result');
      resultDiv.className = 'error';
      resultDiv.innerHTML = `<p>${message}</p>`;
      resultDiv.style.display = 'block';
    }
  </script>
</body>
</html>